--[[
    Custom Sound Script for Roblox
    Original by: Bangyan ¬© 2025
    Custom by: ItoRenz00
    
    Features:
    - Custom jump sounds
    - Multiple walk sound options (Squidward, SpongeBob, Mr. Krabs)
    - Mobile-friendly GUI
    - Persistent settings across respawns
    - Smooth animations and transitions
]]

-- ============ PLAYER REFERENCES ============
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

-- ============ SOUND IDS ============
local JUMP_ID = "rbxassetid://115680913237541"
local WALK_ID = "rbxassetid://6929242058"
local SPONGEBOB_WALK_ID = "rbxassetid://5948749731"
local MRKRAB_WALK_ID = "rbxassetid://3426632334"

-- ============ SCRIPT PROTECTION ============
if not script:FindFirstChild("BangyanSignature") then
    local tag = Instance.new("StringValue")
    tag.Name = "BangyanSignature"
    tag.Value = "Protected by Bangyan ¬© 2025 | Custom by: ItoRenz00"
    tag.Parent = script
end

task.spawn(function()
    while task.wait(10) do
        if not script:FindFirstChild("BangyanSignature") then
            warn("‚ö†Ô∏è Original script by Bangyan | Customized by ItoRenz00")
        end
    end
end)

-- ============ DEFAULT SOUND MANAGEMENT ============
local defaultJumpSound = nil
local defaultFootstepSound = nil

local function hideDefaultSounds(char)
    -- Hide default jump sound
    if char:FindFirstChild("Jump") then
        defaultJumpSound = char:FindFirstChild("Jump")
        defaultJumpSound.Volume = 0
    end
    if humanoid:FindFirstChild("Jump") then
        defaultJumpSound = humanoid:FindFirstChild("Jump")
        defaultJumpSound.Volume = 0
    end
    
    -- Hide default footstep/running sounds
    for _, sound in pairs(char:GetDescendants()) do
        if sound:IsA("Sound") and (sound.Name == "Footstep" or sound.Name == "Running") then
            defaultFootstepSound = sound
            defaultFootstepSound.Volume = 0
        end
    end
    
    for _, sound in pairs(humanoid:GetChildren()) do
        if sound:IsA("Sound") and (sound.Name == "Footstep" or sound.Name == "Running") then
            defaultFootstepSound = sound
            defaultFootstepSound.Volume = 0
        end
    end
end

hideDefaultSounds(character)

-- ============ CUSTOM SOUND SETUP ============
local jumpSound = Instance.new("Sound")
jumpSound.Name = "CustomJump"
jumpSound.SoundId = JUMP_ID
jumpSound.Volume = 1
jumpSound.Looped = false
jumpSound.Parent = rootPart

local walkSound = Instance.new("Sound")
walkSound.Name = "CustomFootstep"
walkSound.SoundId = WALK_ID
walkSound.Volume = 1
walkSound.Looped = true
walkSound.PlaybackSpeed = 1
walkSound.RollOffMaxDistance = 100
walkSound.RollOffMinDistance = 10
walkSound.Parent = rootPart

-- ============ STATE VARIABLES ============
local jumpEnabled = true
local walkEnabled = true
local isWalking = false
local isJumping = false
local lastJumpTime = 0
local MIN_JUMP_INTERVAL = 0.05
local currentWalkSound = "SQUID"
local allSoundsEnabled = true

-- Saved states for respawn
local savedJumpEnabled = jumpEnabled
local savedWalkEnabled = walkEnabled
local savedCurrentWalkSound = currentWalkSound
local savedAllSoundsEnabled = allSoundsEnabled

-- Connection variables
local jumpConnection = nil
local runConnection = nil
local stateConnection = nil
local heartbeatConnection = nil

-- ============ JUMP HANDLER ============
local function onJump(jumping)
    if not jumping then return end
    
    local currentTime = tick()
    if currentTime - lastJumpTime < MIN_JUMP_INTERVAL then return end
    
    lastJumpTime = currentTime
    
    if jumpEnabled and allSoundsEnabled then
        if jumpSound.IsPlaying then
            jumpSound:Stop()
        end
        
        if defaultJumpSound then
            defaultJumpSound.Volume = 0
        end
        
        task.spawn(function()
            jumpSound.TimePosition = 0
            jumpSound:Play()
        end)
    elseif defaultJumpSound then
        defaultJumpSound.Volume = 1
    end
end

-- ============ WALK HANDLERS ============
local function ensureSoundPlaying()
    if walkEnabled and allSoundsEnabled and isWalking and not isJumping then
        if not walkSound.IsPlaying then
            walkSound:Play()
        end
    elseif walkSound.IsPlaying then
        walkSound:Stop()
    end
end

local function handleWalking(speed)
    if not allSoundsEnabled or not walkEnabled then
        isWalking = false
        if walkSound.IsPlaying then
            walkSound:Stop()
        end
        if defaultFootstepSound then
            defaultFootstepSound.Volume = not allSoundsEnabled and 1 or 0
        end
        return
    end
    
    if speed > 2 and humanoid.FloorMaterial ~= Enum.Material.Air then
        isWalking = true
        if defaultFootstepSound then
            defaultFootstepSound.Volume = 0
        end
        if not walkSound.IsPlaying and not isJumping then
            walkSound:Play()
        end
    else
        isWalking = false
        if walkSound.IsPlaying then
            walkSound:Stop()
        end
    end
end

local function handleStateChanged(oldState, newState)
    if newState == Enum.HumanoidStateType.Jumping or newState == Enum.HumanoidStateType.Freefall then
        isJumping = true
        if walkSound.IsPlaying then
            walkSound:Stop()
        end
    elseif newState == Enum.HumanoidStateType.Landed then
        isJumping = false
        if isWalking and walkEnabled and allSoundsEnabled then
            walkSound:Play()
        end
    end
end

-- ============ CONNECT EVENTS ============
jumpConnection = humanoid.Jumping:Connect(onJump)
runConnection = humanoid.Running:Connect(handleWalking)
stateConnection = humanoid.StateChanged:Connect(handleStateChanged)
heartbeatConnection = game:GetService("RunService").Heartbeat:Connect(ensureSoundPlaying)

-- ============ PLATFORM DETECTION ============
local UserInputService = game:GetService("UserInputService")
local isMobile = UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled

-- ============ GUI SETUP ============
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SoundTogglePanel"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = player:WaitForChild("PlayerGui")

-- ============ TOGGLE BUTTON CONTAINER ============
local toggleContainer = Instance.new("Frame")
toggleContainer.Name = "ToggleContainer"
toggleContainer.Size = UDim2.new(0, 32, 0, 32)
toggleContainer.Position = UDim2.new(0, 10, 0, 10)
toggleContainer.BackgroundTransparency = 1
toggleContainer.Parent = screenGui

local containerCorner = Instance.new("UICorner")
containerCorner.CornerRadius = UDim.new(0, 10)
containerCorner.Parent = toggleContainer

local stroke = Instance.new("UIStroke")
stroke.Color = Color3.fromRGB(0, 0, 0)
stroke.Thickness = 1
stroke.Transparency = 0.5
stroke.Parent = toggleContainer

local toggleButton = Instance.new("TextButton")
toggleButton.Name = "MainToggleBtn"
toggleButton.Size = UDim2.new(1, 0, 1, 0)
toggleButton.BackgroundColor3 = Color3.fromRGB(52, 152, 219)
toggleButton.BorderSizePixel = 0
toggleButton.Text = "üë£"
toggleButton.TextSize = 18
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.ZIndex = 10
toggleButton.Parent = toggleContainer

local buttonCorner = Instance.new("UICorner")
buttonCorner.CornerRadius = UDim.new(0, 10)
buttonCorner.Parent = toggleButton

-- ============ MENU PANEL ============
local menuPanel = Instance.new("Frame")
menuPanel.Name = "MenuPanel"
menuPanel.Size = UDim2.new(0, 86, 0, 140)
menuPanel.Position = UDim2.new(0, 45, 0, 10)
menuPanel.BackgroundColor3 = Color3.fromRGB(44, 62, 80)
menuPanel.BorderSizePixel = 0
menuPanel.Visible = false
menuPanel.ZIndex = 9
menuPanel.Parent = screenGui

local menuCorner = Instance.new("UICorner")
menuCorner.CornerRadius = UDim.new(0, 10)
menuCorner.Parent = menuPanel

local menuStroke = Instance.new("UIStroke")
menuStroke.Color = Color3.fromRGB(0, 0, 0)
menuStroke.Thickness = 1
menuStroke.Transparency = 0.5
menuStroke.Parent = menuPanel

-- ============ MENU BUTTON CREATOR ============
local function createMenuButton(name, yPos)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Size = UDim2.new(1, -8, 0, 22)
    btn.Position = UDim2.new(0, 4, 0, yPos)
    btn.BackgroundColor3 = Color3.fromRGB(52, 73, 94)
    btn.BorderSizePixel = 0
    btn.TextSize = 9
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.GothamSemibold
    btn.ZIndex = 10
    btn.Parent = menuPanel
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 5)
    btnCorner.Parent = btn
    
    return btn
end

local jumpBtn = createMenuButton("JumpBtn", 3)
jumpBtn.Text = "UNYAH"
jumpBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)

local walkBtn = createMenuButton("WalkBtn", 28)
walkBtn.Text = "SQUID"
walkBtn.BackgroundColor3 = Color3.fromRGB(46, 204, 113)

local spongebobBtn = createMenuButton("SpongebobBtn", 53)
spongebobBtn.Text = "SPONGEBOB"
spongebobBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)

local mrkrabBtn = createMenuButton("MrkrabBtn", 78)
mrkrabBtn.Text = "MR. KRAB"
mrkrabBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)

local offBtn = createMenuButton("OffBtn", 103)
offBtn.Text = "OFF"
offBtn.BackgroundColor3 = Color3.fromRGB(231, 76, 60)

-- ============ MENU TOGGLE FUNCTION ============
local menuOpen = false
local function toggleMenu()
    menuOpen = not menuOpen
    menuPanel.Visible = menuOpen
    
    local tweenService = game:GetService("TweenService")
    local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local newColor = menuOpen and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(52, 152, 219)
    
    tweenService:Create(toggleButton, tweenInfo, {BackgroundColor3 = newColor}):Play()
end

-- ============ BUTTON EVENT HANDLERS ============
toggleButton.MouseButton1Click:Connect(toggleMenu)

toggleButton.MouseButton1Down:Connect(function()
    local tween = game:GetService("TweenService"):Create(
        toggleButton, 
        TweenInfo.new(0.15, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), 
        {Rotation = 20}
    )
    tween:Play()
end)

toggleButton.MouseButton1Up:Connect(function()
    local tween = game:GetService("TweenService"):Create(
        toggleButton, 
        TweenInfo.new(0.15, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut), 
        {Rotation = 0}
    )
    tween:Play()
end)

jumpBtn.MouseButton1Click:Connect(function()
    if not allSoundsEnabled then return end
    
    jumpEnabled = not jumpEnabled
    savedJumpEnabled = jumpEnabled
    
    local newColor = jumpEnabled and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(231, 76, 60)
    game:GetService("TweenService"):Create(
        jumpBtn, 
        TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), 
        {BackgroundColor3 = newColor}
    ):Play()
end)

local function switchWalkSound(soundType, soundId, button)
    if not allSoundsEnabled then return end
    
    currentWalkSound = soundType
    savedCurrentWalkSound = currentWalkSound
    walkSound.SoundId = soundId
    walkEnabled = true
    savedWalkEnabled = true
    
    local tweenService = game:GetService("TweenService")
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    -- Update button colors
    tweenService:Create(button, tweenInfo, {BackgroundColor3 = Color3.fromRGB(46, 204, 113)}):Play()
    
    for _, btn in pairs({walkBtn, spongebobBtn, mrkrabBtn, offBtn}) do
        if btn ~= button then
            tweenService:Create(btn, tweenInfo, {BackgroundColor3 = Color3.fromRGB(231, 76, 60)}):Play()
        end
    end
    
    -- Restart sound if walking
    if isWalking then
        if walkSound.IsPlaying then
            walkSound:Stop()
        end
        walkSound:Play()
    end
end

walkBtn.MouseButton1Click:Connect(function()
    switchWalkSound("SQUID", WALK_ID, walkBtn)
end)

spongebobBtn.MouseButton1Click:Connect(function()
    switchWalkSound("SPONGEBOB", SPONGEBOB_WALK_ID, spongebobBtn)
end)

mrkrabBtn.MouseButton1Click:Connect(function()
    switchWalkSound("MRKRAB", MRKRAB_WALK_ID, mrkrabBtn)
end)

offBtn.MouseButton1Click:Connect(function()
    allSoundsEnabled = not allSoundsEnabled
    savedAllSoundsEnabled = allSoundsEnabled
    
    local tweenService = game:GetService("TweenService")
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    if allSoundsEnabled then
        tweenService:Create(offBtn, tweenInfo, {BackgroundColor3 = Color3.fromRGB(231, 76, 60)}):Play()
        
        -- Restore button states
        local jumpColor = jumpEnabled and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(231, 76, 60)
        tweenService:Create(jumpBtn, tweenInfo, {BackgroundColor3 = jumpColor}):Play()
        
        -- Update walk buttons based on current sound
        local activeWalkBtn = currentWalkSound == "SQUID" and walkBtn or 
                              (currentWalkSound == "SPONGEBOB" and spongebobBtn or mrkrabBtn)
        
        for _, btn in pairs({walkBtn, spongebobBtn, mrkrabBtn}) do
            local color = (btn == activeWalkBtn) and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(231, 76, 60)
            tweenService:Create(btn, tweenInfo, {BackgroundColor3 = color}):Play()
        end
        
        -- Disable default sounds
        if defaultJumpSound then defaultJumpSound.Volume = 0 end
        if defaultFootstepSound then defaultFootstepSound.Volume = 0 end
        
        if isWalking and walkEnabled then
            walkSound:Play()
        end
    else
        -- All custom sounds OFF
        tweenService:Create(offBtn, tweenInfo, {BackgroundColor3 = Color3.fromRGB(46, 204, 113)}):Play()
        
        for _, btn in pairs({jumpBtn, walkBtn, spongebobBtn, mrkrabBtn}) do
            tweenService:Create(btn, tweenInfo, {BackgroundColor3 = Color3.fromRGB(231, 76, 60)}):Play()
        end
        
        if jumpSound.IsPlaying then jumpSound:Stop() end
        if walkSound.IsPlaying then walkSound:Stop() end
        
        -- Enable default sounds
        if defaultJumpSound then defaultJumpSound.Volume = 1 end
        if defaultFootstepSound then defaultFootstepSound.Volume = 1 end
    end
end)

-- ============ HOVER EFFECTS ============
local function addHoverEffect(btn)
    btn.MouseEnter:Connect(function()
        game:GetService("TweenService"):Create(
            btn, 
            TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), 
            {BackgroundTransparency = 0.1}
        ):Play()
    end)
    
    btn.MouseLeave:Connect(function()
        game:GetService("TweenService"):Create(
            btn, 
            TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), 
            {BackgroundTransparency = 0}
        ):Play()
    end)
end

for _, btn in pairs({jumpBtn, walkBtn, spongebobBtn, mrkrabBtn, offBtn}) do
    addHoverEffect(btn)
end

-- ============ RESPAWN HANDLER ============
player.CharacterAdded:Connect(function(newChar)
    character = newChar
    humanoid = character:WaitForChild("Humanoid")
    rootPart = character:WaitForChild("HumanoidRootPart")
    
    hideDefaultSounds(character)
    
    -- Cleanup old sounds
    if jumpSound then jumpSound:Destroy() end
    if walkSound then walkSound:Destroy() end
    
    -- Recreate sounds
    jumpSound = Instance.new("Sound")
    jumpSound.Name = "CustomJump"
    jumpSound.SoundId = JUMP_ID
    jumpSound.Volume = 1
    jumpSound.Looped = false
    jumpSound.Parent = rootPart
    
    local currentSoundId = currentWalkSound == "SPONGEBOB" and SPONGEBOB_WALK_ID or 
                           (currentWalkSound == "MRKRAB" and MRKRAB_WALK_ID or WALK_ID)
    
    walkSound = Instance.new("Sound")
    walkSound.Name = "CustomFootstep"
    walkSound.SoundId = currentSoundId
    walkSound.Volume = 1
    walkSound.Looped = true
    walkSound.PlaybackSpeed = 1
    walkSound.RollOffMaxDistance = 100
    walkSound.RollOffMinDistance = 10
    walkSound.Parent = rootPart
    
    -- Reset state
    lastJumpTime = 0
    isWalking = false
    isJumping = false
    
    -- Restore saved settings
    jumpEnabled = savedJumpEnabled
    walkEnabled = savedWalkEnabled
    currentWalkSound = savedCurrentWalkSound
    allSoundsEnabled = savedAllSoundsEnabled
    
    -- Reconnect events
    if jumpConnection then jumpConnection:Disconnect() end
    if runConnection then runConnection:Disconnect() end
    if stateConnection then stateConnection:Disconnect() end
    if heartbeatConnection then heartbeatConnection:Disconnect() end
    
    jumpConnection = humanoid.Jumping:Connect(onJump)
    runConnection = humanoid.Running:Connect(handleWalking)
    stateConnection = humanoid.StateChanged:Connect(handleStateChanged)
    heartbeatConnection = game:GetService("RunService").Heartbeat:Connect(ensureSoundPlaying)
    
    -- Update UI
    local tweenService = game:GetService("TweenService")
    local tweenInfo = TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    local jumpColor = jumpEnabled and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(231, 76, 60)
    tweenService:Create(jumpBtn, tweenInfo, {BackgroundColor3 = jumpColor}):Play()
    
    local activeWalkBtn = currentWalkSound == "SQUID" and walkBtn or 
                          (currentWalkSound == "SPONGEBOB" and spongebobBtn or mrkrabBtn)
    
    for _, btn in pairs({walkBtn, spongebobBtn, mrkrabBtn}) do
        local color = (btn == activeWalkBtn) and Color3.fromRGB(46, 204, 113) or Color3.fromRGB(231, 76, 60)
        tweenService:Create(btn, tweenInfo, {BackgroundColor3 = color}):Play()
    end
    
    local offColor = allSoundsEnabled and Color3.fromRGB(231, 76, 60) or Color3.fromRGB(46, 204, 113)
    tweenService:Create(offBtn, tweenInfo, {BackgroundColor3 = offColor}):Play()
    
    menuOpen = false
    menuPanel.Visible = false
end)

-- ============ CLEANUP ON CHARACTER REMOVAL ============
player.CharacterRemoving:Connect(function()
    if jumpConnection then jumpConnection:Disconnect() end
    if runConnection then runConnection:Disconnect() end
    if stateConnection then stateConnection:Disconnect() end
    if heartbeatConnection then heartbeatConnection:Disconnect() end
    if jumpSound then jumpSound:Destroy() end
    if walkSound then walkSound:Destroy() end
end)
